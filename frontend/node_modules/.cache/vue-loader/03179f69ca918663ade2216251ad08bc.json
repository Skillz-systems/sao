{"remainingRequest":"/Users/kingsonly/Documents/tentacular/all_in_one/sao/sao-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/kingsonly/Documents/tentacular/all_in_one/sao/sao-frontend/src/views/Messages.vue?vue&type=style&index=0&id=2f53e4f4&scoped=true&lang=css&","dependencies":[{"path":"/Users/kingsonly/Documents/tentacular/all_in_one/sao/sao-frontend/src/views/Messages.vue","mtime":1680088796555},{"path":"/Users/kingsonly/Documents/tentacular/all_in_one/sao/sao-frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kingsonly/Documents/tentacular/all_in_one/sao/sao-frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/kingsonly/Documents/tentacular/all_in_one/sao/sao-frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/kingsonly/Documents/tentacular/all_in_one/sao/sao-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kingsonly/Documents/tentacular/all_in_one/sao/sao-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KW2Rpcl0gLmlucHV0LWdyb3VwOm5vdCguYm9vdHN0cmFwLXRvdWNoc3Bpbik6Zm9jdXMtd2l0aGluIC5mb3JtLWNvbnRyb2wsIFtkaXJdIC5pbnB1dC1ncm91cDpub3QoLmJvb3RzdHJhcC10b3VjaHNwaW4pOmZvY3VzLXdpdGhpbiAuaW5wdXQtZ3JvdXAtdGV4dCB7DQogIGJvcmRlci1jb2xvcjogIzRENkQ4QTsNCn0NCg0KLnNjcm9sbC1hcmVhIHsNCiAgcG9zaXRpb246IHJlbGF0aXZlOw0KICBtYXJnaW46IGF1dG87DQogIC8vd2lkdGg6IDQwMHB4Ow0KICBoZWlnaHQ6IDYwdmg7DQogIG1heC1oZWlnaHQ6IDYwdmg7DQp9DQoNCltkaXJdIC5mb3JtLWNvbnRyb2w6Zm9jdXMgew0KICBib3JkZXItY29sb3I6ICM0RDZEOEE7DQp9DQoNCg=="},{"version":3,"sources":["Messages.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkbA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Messages.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <b-row>\r\n      <b-col\r\n        lg=\"4\"\r\n        class=\"d-lg-block d-none\"\r\n      >\r\n        <b-card\r\n          no-body\r\n        >\r\n          <b-card-header style=\"flex-wrap: nowrap\">\r\n            <b-input-group class=\"input-group-merge\">\r\n              <b-input-group-prepend is-text>\r\n                <feather-icon\r\n                  icon=\"SearchIcon\"\r\n                  class=\"text-muted\"\r\n                />\r\n              </b-input-group-prepend>\r\n              <b-form-input\r\n                placeholder=\"Search messages\"\r\n              />\r\n            </b-input-group>\r\n            <b-dropdown\r\n              v-b-tooltip.hover.top=\"'Select Project'\"\r\n              variant=\"link\"\r\n              no-caret\r\n              class=\"chart-dropdown ml-1\"\r\n              toggle-class=\"p-0\"\r\n            >\r\n              <template #button-content>\r\n                <feather-icon\r\n                  icon=\"MoreVerticalIcon\"\r\n                  size=\"18\"\r\n                  class=\"text-body cursor-pointer\"\r\n                />\r\n              </template>\r\n              <b-dropdown-item\r\n                v-for=\"project in projects\"\r\n                :key=\"project.value\"\r\n                @click=\"getProjectMessages(project.value, project.key)\"\r\n              >\r\n                {{ project.key }}\r\n              </b-dropdown-item>\r\n            </b-dropdown>\r\n          </b-card-header>\r\n          <hr class=\"mt-0\">\r\n          <div\r\n            class=\"custom-scroll mt-1\"\r\n          >\r\n            <vue-perfect-scrollbar\r\n              :settings=\"perfectScrollbarSettings\"\r\n              class=\"scroll-area\"\r\n            >\r\n              <h4\r\n                v-if=\"!currentProject\"\r\n                class=\"px-2\"\r\n              >\r\n                Select Project\r\n              </h4>\r\n              <div\r\n                v-if=\"currentProject\"\r\n                class=\"px-2 d-flex justify-content-between\"\r\n              >\r\n                <h4>\r\n                  {{ currentProject }}\r\n                </h4>\r\n                <b-spinner\r\n                  v-if=\"!loadedMessages\"\r\n                  style=\"width: 1.1em; height: 1.1em\"\r\n                  variant=\"primary\"\r\n                  label=\"Loading...\" type=\"grow\"\r\n                  class=\"text-center\"\r\n                />\r\n              </div>\r\n              <b-list-group\r\n                v-if=\"messages.length > 0\"\r\n                flush\r\n              >\r\n                <b-list-group-item\r\n                  v-for=\"message in messages\"\r\n                  :key=\"message.id\"\r\n                  href=\"javascript:void(0)\"\r\n                  @click=\"viewMessage(message)\"\r\n                >\r\n                  <div class=\"flex-column align-items-start\">\r\n                    <div class=\"d-flex w-100 justify-content-between\">\r\n                      <h5 style=\"margin-bottom: 0.5em\">\r\n                        {{ message.subject }}\r\n                      </h5>\r\n                    </div>\r\n                    <p class=\"mb-0\">\r\n                      <span class=\"bullet bullet-success bullet-sm svg-font-small-3 mr-50 cursor-pointer\" />\r\n                      {{ message.sendername }}\r\n                    </p>\r\n                    <small class=\"text-muted\">{{ message.date }}</small>\r\n                  </div>\r\n                </b-list-group-item>\r\n              </b-list-group>\r\n            </vue-perfect-scrollbar>\r\n          </div>\r\n        </b-card>\r\n      </b-col>\r\n      <b-col lg=\"8\">\r\n        <b-card\r\n          no-body\r\n          style=\"height: 73vh\"\r\n        >\r\n          <b-card-header class=\"d-block\">\r\n            <b-link\r\n              v-b-toggle.sidebar-1\r\n              class=\"d-lg-none\"\r\n              style=\"margin-top: 0.3em; color: #878491\"\r\n            >\r\n              <feather-icon\r\n                icon=\"MenuIcon\"\r\n                size=\"30\"\r\n              />\r\n            </b-link>\r\n            <div v-if=\"isHidden\">\r\n              <h4\r\n                class=\"mt-lg-0 mt-2 mb-1\"\r\n              >\r\n                {{ currentMessage.subject }}\r\n              </h4>\r\n              <b-media>\r\n                <template #aside>\r\n                  <b-avatar\r\n                    size=\"62\"\r\n                    class=\"cursor-pointer badge-minimal avatar-border-2\"\r\n                    :src=\"require('@/assets/images/avatars/view-project-avatar.svg')\"\r\n                    variant=\"transparent\"\r\n                    badge\r\n                    badge-variant=\"dark\"\r\n                  />\r\n                </template>\r\n                <h5 class=\"mt-1\">\r\n                  {{ currentMessage.sendername }}\r\n                </h5>\r\n                <p class=\"mt-0 text-muted\">\r\n                  {{ currentMessage.date }}\r\n                </p>\r\n              </b-media>\r\n            </div>\r\n          </b-card-header>\r\n          <hr\r\n            v-if=\"isHidden\"\r\n            class=\"mt-n1\"\r\n          >\r\n          <div\r\n            v-if=\"!isHidden\"\r\n            style=\"display: flex; justify-content: center; align-items: center; padding-top: 5em\"\r\n          >\r\n            <b-img\r\n              :src=\"require('@/assets/images/icons/messages-icon.svg')\"\r\n            />\r\n          </div>\r\n          <div\r\n            v-if=\"!isHidden\"\r\n            class=\"mt-2 text-center mr-auto ml-auto\"\r\n            style=\"border: 0.5px solid #C4C4C4; box-sizing: border-box; border-radius: 50px; padding: 10px 15px 5px 15px;\"\r\n          >\r\n            <h5\r\n              style=\"color: #4D6D8A\"\r\n            >\r\n              Select a message to view the message and reply\r\n            </h5>\r\n          </div>\r\n          <vue-perfect-scrollbar\r\n            v-if=\"isHidden\"\r\n            :settings=\"perfectScrollbarSettings\"\r\n            class=\"scroll-area\"\r\n          >\r\n            <b-card-body>\r\n              <p>\r\n                {{ currentMessage.message }}\r\n              </p>\r\n            </b-card-body>\r\n          </vue-perfect-scrollbar>\r\n          <hr v-if=\"isHidden\">\r\n          <b-card-body\r\n            v-if=\"isHidden\"\r\n            class=\"mt-n1 mb-1\"\r\n          >\r\n            <validation-observer ref=\"sendReplyValidation\">\r\n              <b-form @submit.prevent>\r\n                <validation-provider\r\n                  #default=\"{ errors }\"\r\n                  name=\"message\"\r\n                  rules=\"required\"\r\n                >\r\n                  <b-form-group>\r\n                    <b-input-group class=\"input-group-merge\">\r\n                      <b-input-group-prepend is-text>\r\n                        <feather-icon\r\n                          icon=\"PaperclipIcon\"\r\n                          class=\"cursor-pointer\"\r\n                        />\r\n                      </b-input-group-prepend>\r\n                      <b-form-textarea\r\n                        v-model=\"reply\"\r\n                        placeholder=\"Reply this message\"\r\n                        no-resize\r\n                        size=\"sm\"\r\n                      />\r\n                      <b-input-group-append is-text>\r\n                        <feather-icon\r\n                          v-if=\"isLoading\"\r\n                          icon=\"MoreHorizontalIcon\"\r\n                          class=\"cursor-pointer\"\r\n                        />\r\n                        <feather-icon\r\n                          v-if=\"!isLoading\"\r\n                          v-b-tooltip.hover.top=\"'Send Message'\"\r\n                          icon=\"SendIcon\"\r\n                          class=\"cursor-pointer\"\r\n                          @click=\"sendReply\"\r\n                        />\r\n                      </b-input-group-append>\r\n                    </b-input-group>\r\n                    <small class=\"text-danger\">{{ errors[0] }}</small>\r\n                  </b-form-group>\r\n                </validation-provider>\r\n              </b-form>\r\n            </validation-observer>\r\n          </b-card-body>\r\n        </b-card>\r\n      </b-col>\r\n    </b-row>\r\n    <b-sidebar\r\n      id=\"sidebar-1\"\r\n      shadow\r\n      backdrop\r\n      lazy\r\n      bg-variant=\"white\"\r\n    >\r\n      <div class=\"px-2 py-2 d-flex justify-content-between align-items-center\">\r\n        <b-input-group class=\"input-group-merge\">\r\n          <b-input-group-prepend is-text>\r\n            <feather-icon\r\n              icon=\"SearchIcon\"\r\n              class=\"text-muted\"\r\n            />\r\n          </b-input-group-prepend>\r\n          <b-form-input\r\n            placeholder=\"Search message or client\"\r\n          />\r\n        </b-input-group>\r\n        <b-dropdown\r\n          v-b-tooltip.hover.top=\"'Select Project'\"\r\n          variant=\"link\"\r\n          no-caret\r\n          class=\"chart-dropdown ml-1\"\r\n          toggle-class=\"p-0\"\r\n        >\r\n          <template #button-content>\r\n            <feather-icon\r\n              icon=\"MoreVerticalIcon\"\r\n              size=\"18\"\r\n              class=\"text-body cursor-pointer\"\r\n            />\r\n          </template>\r\n          <b-dropdown-item\r\n            v-for=\"project in projects\"\r\n            :key=\"project.value\"\r\n            @click=\"getProjectMessages(project.value, project.key)\"\r\n          >\r\n            {{ project.key }}\r\n          </b-dropdown-item>\r\n        </b-dropdown>\r\n\r\n      </div>\r\n      <hr class=\"mt-0\">\r\n      <div\r\n        class=\"custom-scroll mt-1\"\r\n      >\r\n        <vue-perfect-scrollbar\r\n          :settings=\"perfectScrollbarSettings\"\r\n          class=\"scroll-area\"\r\n        >\r\n          <h4\r\n            v-if=\"!currentProject\"\r\n            class=\"px-2\"\r\n          >\r\n            Select Project\r\n          </h4>\r\n          <div\r\n            v-if=\"currentProject\"\r\n            class=\"px-2 d-flex justify-content-between\"\r\n          >\r\n            <h4>\r\n              {{ currentProject }}\r\n            </h4>\r\n            <b-spinner\r\n              v-if=\"!loadedMessages\"\r\n              style=\"width: 1.1em; height: 1.1em\"\r\n              variant=\"dark\"\r\n              label=\"Loading...\" type=\"grow\"\r\n              class=\"text-center\"\r\n            />\r\n          </div>\r\n          <b-list-group\r\n            v-if=\"messages.length > 0\"\r\n            flush\r\n          >\r\n            <b-list-group-item\r\n              v-for=\"message in messages\"\r\n              :key=\"message.id\"\r\n              v-b-toggle.sidebar-1\r\n              href=\"javascript:void(0)\"\r\n              @click=\"viewMessage(message)\"\r\n            >\r\n              <div class=\"flex-column align-items-start\">\r\n                <div class=\"d-flex w-100 justify-content-between\">\r\n                  <h5 style=\"margin-bottom: 0.5em\">\r\n                    {{ message.subject }}\r\n                  </h5>\r\n                </div>\r\n                <p class=\"mb-0\">\r\n                  <span class=\"bullet bullet-success bullet-sm svg-font-small-3 mr-50 cursor-pointer\" />\r\n                  {{ message.sendername }}\r\n                </p>\r\n                <small class=\"text-muted\">{{ message.date }}</small>\r\n              </div>\r\n            </b-list-group-item>\r\n          </b-list-group>\r\n        </vue-perfect-scrollbar>\r\n      </div>\r\n    </b-sidebar>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport VuePerfectScrollbar from 'vue-perfect-scrollbar'\r\nimport { ValidationObserver, ValidationProvider } from 'vee-validate'\r\nimport { required } from '@validations'\r\n\r\nexport default {\r\n  components: {\r\n    VuePerfectScrollbar,\r\n    ValidationProvider,\r\n    ValidationObserver,\r\n  },\r\n  data() {\r\n    return {\r\n      isLoading: false,\r\n      perfectScrollbarSettings: {\r\n        maxScrollbarLength: 60,\r\n      },\r\n      isHidden: false,\r\n      sidebar: false,\r\n      projects: [],\r\n      messages: [],\r\n      currentProject: null,\r\n      currentProjectID: null,\r\n      currentMessage: null,\r\n      loadedMessages: false,\r\n      reply: null,\r\n      required,\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      userType: 'auth/getUserType',\r\n    }),\r\n  },\r\n  created() {\r\n    this.getProjects()\r\n  },\r\n  mounted() {\r\n    document.getElementById('custom-breadcrumb').innerHTML = 'Messages'\r\n  },\r\n  methods: {\r\n    getProjects() {\r\n      if (this.userType === 'client') {\r\n        this.$store.dispatch('project/getClientProjects').then(res => {\r\n          const { data } = res.data\r\n          data.forEach(project => {\r\n            this.projects.push({ key: project.projectname, value: project.id })\r\n          })\r\n        })\r\n      } else {\r\n        this.$store.dispatch('project/getProjects').then(res => {\r\n          const { data } = res.data\r\n          data.forEach(project => {\r\n            this.projects.push({ key: project.projectname, value: project.id })\r\n          })\r\n        })\r\n      }\r\n    },\r\n    getProjectMessages(projectID, projectName) {\r\n      this.loadedMessages = false\r\n      this.currentProject = projectName\r\n      this.currentProjectID = projectID\r\n      this.messages = []\r\n      this.$store.dispatch('message/getMessageByProjectID', { projectID }).then(res => {\r\n        const { data } = res.data\r\n        this.messages = data\r\n        this.loadedMessages = true\r\n      })\r\n    },\r\n    viewMessage(message) {\r\n      this.isHidden = true\r\n      this.currentMessage = message\r\n    },\r\n    sendReply() {\r\n      this.isLoading = true\r\n      this.$refs.sendReplyValidation.validate().then(success => {\r\n        if (success) {\r\n          const form = {\r\n            projectID: this.currentProjectID,\r\n            subject: this.currentMessage.subject,\r\n            message: this.reply,\r\n          }\r\n          this.$store.dispatch('project/sendMessage', { form }).then(res => {\r\n            this.isLoading = false\r\n            const { message } = res.data\r\n            this.getProjectMessages(this.currentProjectID, this.currentProject)\r\n            this.toast('Send Message', 'CheckCircleIcon', message, 'success')\r\n          }).catch(err => {\r\n            this.isLoading = false\r\n            this.toast('Send Message', 'SlashIcon', err.response.data.message, 'danger')\r\n          })\r\n        } else {\r\n          this.isLoading = false\r\n          this.toast('Send Reply Attempt', 'AlertTriangleIcon', 'You must fill in all required fields', 'warning')\r\n        }\r\n      })\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n[dir] .input-group:not(.bootstrap-touchspin):focus-within .form-control, [dir] .input-group:not(.bootstrap-touchspin):focus-within .input-group-text {\r\n  border-color: #4D6D8A;\r\n}\r\n\r\n.scroll-area {\r\n  position: relative;\r\n  margin: auto;\r\n  //width: 400px;\r\n  height: 60vh;\r\n  max-height: 60vh;\r\n}\r\n\r\n[dir] .form-control:focus {\r\n  border-color: #4D6D8A;\r\n}\r\n\r\n</style>\r\n"]}]}